<section class="page space-y-4">
	<div class="flex flex-wrap items-center justify-between gap-2">
		<div class="flex flex-wrap gap-2">
			<ui-button variant="ghost" size="sm" type="button" (click)="back()">‚Üê Volver</ui-button>
			<ui-button variant="ghost" size="sm" type="button" (click)="reload()">Recargar</ui-button>
		</div>

		@if (vm$ | async; as vm) {
		@if (!vm.loading && vm.debt) {
		<ui-button variant="ghost" size="sm" type="button" (click)="edit(vm.id)">Editar</ui-button>
		}
		}
	</div>

	@if (actionError) {
	<ui-alert tone="danger" [message]="actionError" />
	}

	@if (vm$ | async; as vm) {
	@if (vm.loading) {
	<ui-card>
		<div class="space-y-3">
			<ui-skeleton [width]="220" [height]="18" />
			<ui-skeleton [width]="140" [height]="14" />
			<div class="pt-2 space-y-2">
				<ui-skeleton [width]="320" />
				<ui-skeleton [width]="260" />
			</div>
			<div class="flex gap-2 pt-2">
				<ui-skeleton [width]="110" [height]="34" />
				<ui-skeleton [width]="110" [height]="34" />
			</div>
		</div>
	</ui-card>
	} @else {
	@if (vm.error) {
	<ui-alert tone="danger" [message]="vm.error" />
	} @else {
	@if (!vm.debt) {
	<ui-alert tone="info" message="No se encontr√≥ la deuda." />
	} @else {
	<ui-card>
		<div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between">
			<div class="min-w-0 space-y-2">
				<div class="flex flex-wrap items-center gap-2">
					<h1 class="text-xl font-semibold truncate">Deuda #{{ vm.debt.id }}</h1>

					@if (vm.debt.status === 'PENDING') {
					<ui-badge tone="warning">PENDING</ui-badge>
					} @else {
					<ui-badge tone="success">PAID</ui-badge>
					}
				</div>

				<p class="text-sm text-white/70">
					Acreedor: <span class="text-white/90 font-medium">{{ vm.debt.creditorName }}</span>
				</p>

				<div class="flex flex-wrap gap-2 text-xs">
					@if (vm.debt.creditorEmail) {
					<ui-badge tone="neutral">üìß {{ vm.debt.creditorEmail }}</ui-badge>
					}
					@if (vm.debt.creditorPhone) {
					<ui-badge tone="neutral">üì± {{ vm.debt.creditorPhone }}</ui-badge>
					}
				</div>
			</div>

			<div class="sm:text-right">
				<div class="text-sm text-white/60">Monto</div>
				<div class="text-2xl font-semibold tracking-tight">${{ vm.debt.amount }}</div>
			</div>
		</div>

		@if (vm.debt.description) {
		<div class="mt-4">
			<ui-card padding="sm" extraClass="bg-black/20">
				<div class="text-sm text-white/80">{{ vm.debt.description }}</div>
			</ui-card>
		</div>
		}

		<div class="mt-6 flex flex-wrap gap-2">
			@if (vm.debt.status === 'PENDING') {
			<ui-button variant="soft" type="button" [disabled]="action !== null" (click)="pay()">
				@if (action === 'pay') { Pagando... } @else { Marcar pagada }
			</ui-button>

			<ui-button variant="danger" type="button" [disabled]="action !== null" (click)="remove()">
				@if (action === 'delete') { Eliminando... } @else { Eliminar }
			</ui-button>
			} @else {
			<ui-alert tone="success" message="Esta deuda est√° pagada ‚úÖ" />
			}
		</div>
	</ui-card>
	}
	}
	}
	}
</section>